<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ—Ç–∏–∫–æ–≤ ‚Äî –ö–æ—Ç–æ—Ñ–∞–±—Ä–∏–∫–∞</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/main.css' %}" />
</head>
<body class="app builder-page">
    <header class="app-header">
        <div class="container app-header__inner">
            <a class="brand" href="{% url 'home' %}"><span class="brand-icon">üêæ</span>–ö–æ—Ç–æ—Ñ–∞–±—Ä–∏–∫–∞</a>
            <nav class="app-header__nav" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
                <a class="app-header__link" href="{% url 'catalog' %}">–ö–∞—Ç–∞–ª–æ–≥</a>
            </nav>
            <div class="app-header__actions">
                <a class="secondary-btn secondary-btn--active" href="{% url 'builder' %}">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</a>
                <a class="ghost-btn" href="{% url 'cart' %}" aria-label="–ö–æ—Ä–∑–∏–Ω–∞">üõí</a>
                <a class="ghost-btn" href="{% url 'profile' %}" aria-label="–ü—Ä–æ—Ñ–∏–ª—å">üë§</a>
            </div>
        </div>
    </header>

    <main>
        <section class="section">
            <div class="container builder-shell">
                <div class="builder-intro">
                    <h1 class="builder-title">
                        {% if user.is_authenticated %}
                        –°–æ–±–µ—Ä–∏—Ç–µ –∫–æ—Ç–∏–∫–∞ –∏–∑ –≤–∞—à–∏—Ö –¥–µ—Ç–∞–ª–µ–π!
                        {% else %}
                        –î–µ–º–æ-—Ä–µ–∂–∏–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
                        {% endif %}
                    </h1>
                    <p class="builder-description text-muted">
                        {% if user.is_authenticated and heads %}
                        –ü–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –∫—É–ø–ª–µ–Ω–Ω—ã–µ –≤–∞–º–∏ –¥–µ—Ç–∞–ª–∏.
                        {% else %}
                        –£ –≤–∞—Å –ø–æ–∫–∞ –º–∞–ª–æ –¥–µ—Ç–∞–ª–µ–π. –ö—É–ø–∏—Ç–µ –Ω–æ–≤—ã–µ —á–∞—Å—Ç–∏ –≤ <a href="{% url 'catalog' %}">–∫–∞—Ç–∞–ª–æ–≥–µ</a>, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –∑–¥–µ—Å—å.
                        {% endif %}
                    </p>
                    <div class="builder-actions">
                        <button class="secondary-btn" onclick="saveCat()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—Ç–∏–∫–∞</button>
                    </div>
                </div>

                <div class="cat-builder" aria-label="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ—Ç–∏–∫–∞">
                    <div class="cat-stage" role="img" aria-label="–í–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ç–∏–∫–∞">
                        <!-- –°—Ç—Ä–µ–ª–∫–∏ –ì–æ–ª–æ–≤—ã -->
                        <button class="arrow-btn head-arrow arrow-btn--left" type="button" onclick="prevHead()" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≥–æ–ª–æ–≤–∞">
                            &#8249;
                        </button>
                        <button class="arrow-btn head-arrow arrow-btn--right" type="button" onclick="nextHead()" aria-label="–°–ª–µ–¥—É—é—â–∞—è –≥–æ–ª–æ–≤–∞">
                            &#8250;
                        </button>

                        <!-- –°—Ç—Ä–µ–ª–∫–∏ –¢–µ–ª–∞ -->
                        <button class="arrow-btn body-arrow arrow-btn--left" type="button" onclick="prevBody()" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Ç–µ–ª–æ">
                            &#8249;
                        </button>
                        <button class="arrow-btn body-arrow arrow-btn--right" type="button" onclick="nextBody()" aria-label="–°–ª–µ–¥—É—é—â–µ–µ —Ç–µ–ª–æ">
                            &#8250;
                        </button>

                        <div class="cat-canvas">
                            <img
                                id="cat-body"
                                class="cat-layer cat-body"
                                src="{% static 'images/body-1.png' %}"
                                alt="–¢–µ–ª–æ –∫–æ—Ç–∏–∫–∞"
                            />
                            <img
                                id="cat-head"
                                class="cat-layer cat-head"
                                src="{% static 'images/head-1.png' %}"
                                alt="–ì–æ–ª–æ–≤–∞ –∫–æ—Ç–∏–∫–∞"
                            />
                        </div>
                    </div>

                    <div class="builder-note">
                        <div class="current-selection">
                            <p><strong>–¢–µ–∫—É—â–∞—è –≥–æ–ª–æ–≤–∞:</strong> <span id="current-head-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span> <span id="current-head-count" class="text-muted"></span></p>
                            <p><strong>–¢–µ–∫—É—â–µ–µ —Ç–µ–ª–æ:</strong> <span id="current-body-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span> <span id="current-body-count" class="text-muted"></span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–∏—Å–ª–∞–ª Django
        const heads = [
            {% for head in heads %}
                { url: "{{ head.image.url }}", name: "{{ head.name }}", id: "{{ head.id }}" },
            {% empty %}
                // –ï—Å–ª–∏ –ø—É—Å—Ç–æ - —Å—Ç–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É
                { url: "{% static 'images/head-1.png' %}", name: "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≥–æ–ª–æ–≤–∞ (–î–µ–º–æ)", id: null },
            {% endfor %}
        ];

        const bodies = [
            {% for body in bodies %}
                { url: "{{ body.image.url }}", name: "{{ body.name }}", id: "{{ body.id }}" },
            {% empty %}
                // –ï—Å–ª–∏ –ø—É—Å—Ç–æ - —Å—Ç–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É
                { url: "{% static 'images/body-1.png' %}", name: "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ç–µ–ª–æ (–î–µ–º–æ)", id: null },
            {% endfor %}
        ];

        let currentHeadIndex = 0;
        let currentBodyIndex = 0;

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateCat() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫–∏
            const headObj = heads[currentHeadIndex];
            const bodyObj = bodies[currentBodyIndex];

            document.getElementById('cat-head').src = headObj.url;
            document.getElementById('cat-body').src = bodyObj.url;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            document.getElementById('current-head-name').textContent = headObj.name;
            document.getElementById('current-body-name').textContent = bodyObj.name;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ (1/5)
            document.getElementById('current-head-count').textContent = `(${currentHeadIndex + 1}/${heads.length})`;
            document.getElementById('current-body-count').textContent = `(${currentBodyIndex + 1}/${bodies.length})`;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å—Ç—Ä–µ–ª–æ–∫
        function nextHead() {
            currentHeadIndex = (currentHeadIndex + 1) % heads.length;
            updateCat();
        }

        function prevHead() {
            currentHeadIndex = (currentHeadIndex - 1 + heads.length) % heads.length;
            updateCat();
        }

        function nextBody() {
            currentBodyIndex = (currentBodyIndex + 1) % bodies.length;
            updateCat();
        }

        function prevBody() {
            currentBodyIndex = (currentBodyIndex - 1 + bodies.length) % bodies.length;
            updateCat();
        }

        function saveCat() {
            alert("–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ç–∏–∫–∞!");
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', updateCat);
    </script>
</body>
</html>